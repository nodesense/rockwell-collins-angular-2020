(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{qvFY:function(t,e,c){"use strict";c.r(e),c.d(e,"ProductModule",(function(){return B}));var n=c("fXoL"),r=c("tyNb");let o=(()=>{class t{constructor(t){this.router=t}canActivate(t,e){return!!window.localStorage.getItem("token")||(this.router.navigateByUrl("/login"),!1)}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(r.b))},t.\u0275prov=n.Eb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),i=(()=>{class t{canActivate(t,e){return window.confirm("Do you want to edit the product?")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=n.Eb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var s=c("PCNd"),u=c("ofXK");const a=function(){return{exact:!0}};let d=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.Cb({type:t,selectors:[["app-product-home"]],decls:9,vars:2,consts:[["routerLink","/products","routerLinkActive","success",1,"button",3,"routerLinkActiveOptions"],["routerLink","/products/create","routerLinkActive","success",1,"button"],["routerLink","/products/search","routerLinkActive","success",1,"button"]],template:function(t,e){1&t&&(n.Lb(0,"h2"),n.nc(1,"Product Home"),n.Kb(),n.Lb(2,"a",0),n.nc(3," List "),n.Kb(),n.Lb(4,"a",1),n.nc(5," Create "),n.Kb(),n.Lb(6,"a",2),n.nc(7," Search "),n.Kb(),n.Jb(8,"router-outlet")),2&t&&(n.yb(2),n.cc("routerLinkActiveOptions",n.dc(1,a)))},directives:[r.d,r.c,r.f],styles:[""]}),t})();var b=c("6xQd"),p=c("AytR"),l=c("tk/3");let h=(()=>{class t{constructor(t){this.http=t}getProducts(){return this.http.get(p.a.apiEndPoint+"/api/products")}searchProducts(t){return this.http.get(`${p.a.apiEndPoint}/api/products?q=${t}`)}getBrands(){return this.http.get(p.a.apiEndPoint+"/api/brands")}getProduct(t){return this.http.get(`${p.a.apiEndPoint}/api/products/${t}`)}saveProduct(t){return t.id?this.http.put(`${p.a.apiEndPoint}/api/products/${t.id}`,t):this.http.post(p.a.apiEndPoint+"/api/products",t)}deleteProduct(t){return this.http.delete(`${p.a.apiEndPoint}/api/products/${t}`)}}return t.\u0275fac=function(e){return new(e||t)(n.Pb(l.b))},t.\u0275prov=n.Eb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var f=c("ABwj");const g=function(t){return["/products","edit",t]};function m(t,e){if(1&t){const t=n.Mb();n.Lb(0,"tr"),n.Lb(1,"td"),n.Lb(2,"a",1),n.nc(3),n.Kb(),n.Kb(),n.Lb(4,"td"),n.nc(5),n.Kb(),n.Lb(6,"td"),n.nc(7),n.Kb(),n.Lb(8,"td"),n.Lb(9,"button",2),n.Tb("click",(function(){n.hc(t);const c=e.$implicit;return n.Vb().addToCart(c)})),n.nc(10," +Cart "),n.Kb(),n.Kb(),n.Kb()}if(2&t){const t=e.$implicit;n.yb(2),n.cc("routerLink",n.ec(4,g,t.id)),n.yb(1),n.pc(" ",t.name," "),n.yb(2),n.oc(t.price),n.yb(2),n.oc(t.year)}}let v=(()=>{class t{constructor(t,e){this.productService=t,this.cartService=e,this.products=[]}ngOnInit(){console.log("ProductTableComponent ngOnInit"),this.subscription=this.productService.getProducts().subscribe(t=>{console.log("received data from api ",t),this.products=t})}addToCart(t){const e=new b.a(t.id,t.name,1,t.price);this.cartService.addItem(e)}ngOnDestroy(){console.log("PRoductTable onDestroy"),this.subscription.unsubscribe(),this.subscription=null}}return t.\u0275fac=function(e){return new(e||t)(n.Ib(h),n.Ib(f.a))},t.\u0275cmp=n.Cb({type:t,selectors:[["app-product-table"]],decls:11,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"routerLink"],[3,"click"]],template:function(t,e){1&t&&(n.Lb(0,"table"),n.Lb(1,"tr"),n.Lb(2,"th"),n.nc(3,"Name"),n.Kb(),n.Lb(4,"th"),n.nc(5,"Price"),n.Kb(),n.Lb(6,"th"),n.nc(7,"Year"),n.Kb(),n.Lb(8,"th"),n.nc(9,"+Cart"),n.Kb(),n.Kb(),n.lc(10,m,11,6,"tr",0),n.Kb()),2&t&&(n.yb(10),n.cc("ngForOf",e.products))},directives:[u.l,r.d],styles:[""]}),t})(),y=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=n.Cb({type:t,selectors:[["app-product-list"]],decls:3,vars:0,template:function(t,e){1&t&&(n.Lb(0,"h2"),n.nc(1,"Product List"),n.Kb(),n.Jb(2,"app-product-table"))},directives:[v],styles:[""]}),t})();class L{}var K=c("3Pt+");const P=["productForm"];function w(t,e){1&t&&(n.Lb(0,"p"),n.nc(1," Form is invalid "),n.Kb())}function C(t,e){1&t&&(n.Lb(0,"p"),n.nc(1," Form is changed "),n.Kb())}function I(t,e){1&t&&(n.Lb(0,"p"),n.nc(1," product name is invalid "),n.Kb())}function k(t,e){if(1&t&&(n.Lb(0,"pre"),n.nc(1),n.Wb(2,"json"),n.Kb()),2&t){n.Vb();const t=n.gc(8);n.yb(1),n.pc("         ",n.Xb(2,1,t.errors),"  \n    ")}}function S(t,e){if(1&t&&(n.Lb(0,"option",11),n.nc(1),n.Kb()),2&t){const t=e.$implicit;n.cc("value",t.id),n.yb(1),n.pc(" ",t.name," ")}}let M=(()=>{class t{constructor(t,e,c){this.route=t,this.router=e,this.productService=c,this.product=new L}ngOnInit(){const t=this.route.snapshot.params.id;console.log("id ",t),t&&this.productService.getProduct(t).subscribe(t=>{this.product=t}),this.brands$=this.productService.getBrands()}cancelEdit(){this.router.navigate(["/","products"])}saveProduct(){this.productService.saveProduct(this.product).subscribe(t=>{console.log("product saved",t),this.product=t})}deleteProduct(){this.productService.deleteProduct(this.product.id).subscribe(t=>{this.router.navigateByUrl("/products")})}get isDirty(){return this.productForm.dirty}}return t.\u0275fac=function(e){return new(e||t)(n.Ib(r.a),n.Ib(r.b),n.Ib(h))},t.\u0275cmp=n.Cb({type:t,selectors:[["app-product-edit"]],viewQuery:function(t,e){var c;1&t&&n.kc(P,!0),2&t&&n.fc(c=n.Ub())&&(e.productForm=c.first)},decls:25,vars:12,consts:[[3,"ngSubmit"],["productForm","ngForm"],[4,"ngIf"],["name","name","required","","minlength","3",3,"ngModel","ngModelChange"],["productName","ngModel"],["name","price","type","number","required","",3,"ngModel","ngModelChange"],["name","year","type","number","required","",3,"ngModel","ngModelChange"],["name","brandId","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","submit",3,"disabled"],[3,"click"],[3,"value"]],template:function(t,e){if(1&t&&(n.Lb(0,"h2"),n.nc(1,"Product Edit"),n.Kb(),n.Lb(2,"form",0,1),n.Tb("ngSubmit",(function(){return e.saveProduct()})),n.lc(4,w,2,0,"p",2),n.lc(5,C,2,0,"p",2),n.nc(6," Name "),n.Lb(7,"input",3,4),n.Tb("ngModelChange",(function(t){return e.product.name=t})),n.Kb(),n.lc(9,I,2,0,"p",2),n.lc(10,k,3,3,"pre",2),n.nc(11," Price "),n.Lb(12,"input",5),n.Tb("ngModelChange",(function(t){return e.product.price=t})),n.Kb(),n.nc(13," Year "),n.Lb(14,"input",6),n.Tb("ngModelChange",(function(t){return e.product.year=t})),n.Kb(),n.nc(15," Brand "),n.Lb(16,"select",7),n.Tb("ngModelChange",(function(t){return e.product.brandId=t})),n.lc(17,S,2,2,"option",8),n.Wb(18,"async"),n.Kb(),n.Lb(19,"button",9),n.nc(20,"Save"),n.Kb(),n.Kb(),n.Lb(21,"button",10),n.Tb("click",(function(){return e.cancelEdit()})),n.nc(22,"Cancel"),n.Kb(),n.Lb(23,"button",10),n.Tb("click",(function(){return e.deleteProduct()})),n.nc(24,"Delete"),n.Kb()),2&t){const t=n.gc(3),c=n.gc(8);n.yb(4),n.cc("ngIf",t.invalid),n.yb(1),n.cc("ngIf",t.dirty),n.yb(2),n.cc("ngModel",e.product.name),n.yb(2),n.cc("ngIf",c.invalid),n.yb(1),n.cc("ngIf",c.errors),n.yb(2),n.cc("ngModel",e.product.price),n.yb(2),n.cc("ngModel",e.product.year),n.yb(2),n.cc("ngModel",e.product.brandId),n.yb(1),n.cc("ngForOf",n.Xb(18,10,e.brands$)),n.yb(2),n.cc("disabled",t.invalid)}},directives:[K.r,K.i,K.j,u.m,K.a,K.o,K.g,K.h,K.k,K.m,K.p,u.l,K.l,K.q],pipes:[u.b,u.g],styles:["input.ng-dirty[_ngcontent-%COMP%]{background:#fafad2}input.ng-invalid[_ngcontent-%COMP%]{border:2px solid red}"]}),t})();var T=c("lJxs"),O=c("pLZG"),F=c("7o/Q"),x=c("3N8a");const E=new(c("IjjT").a)(x.a);class ${constructor(t,e){this.dueTime=t,this.scheduler=e}call(t,e){return e.subscribe(new D(t,this.dueTime,this.scheduler))}}class D extends F.a{constructor(t,e,c){super(t),this.dueTime=e,this.scheduler=c,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(A,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:t}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}clearDebounce(){const t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}function A(t){t.debouncedNext()}function N(t,e){if(1&t&&(n.Lb(0,"tr"),n.Lb(1,"td"),n.Lb(2,"span"),n.nc(3),n.Kb(),n.Kb(),n.Kb()),2&t){const t=e.$implicit;n.yb(3),n.oc(t.name)}}let V=(()=>{class t{constructor(t,e){this.productService=t,this.formBuilder=e,this.products=[],this.searchText="",this.searchControl=new K.c(""),this.form=e.group({searchControl:this.searchControl})}ngOnInit(){this.searchControl.valueChanges.pipe(Object(T.a)(t=>t.trim().toLowerCase())).pipe(Object(O.a)(t=>!!t)).pipe(function(t,e=E){return c=>c.lift(new $(t,e))}(400)).subscribe(t=>{console.log("searching for *"+t+"*"),this.searchText=t,this.productService.searchProducts(this.searchText).subscribe(t=>{this.products=t})})}}return t.\u0275fac=function(e){return new(e||t)(n.Ib(h),n.Ib(K.b))},t.\u0275cmp=n.Cb({type:t,selectors:[["app-product-search"]],decls:14,vars:3,consts:[[3,"formGroup"],["type","text","formControlName","searchControl"],[4,"ngFor","ngForOf"]],template:function(t,e){1&t&&(n.Lb(0,"h2"),n.nc(1,"Product Search"),n.Kb(),n.Lb(2,"form",0),n.Lb(3,"p"),n.Lb(4,"label"),n.nc(5,"Search "),n.Kb(),n.Jb(6,"input",1),n.Kb(),n.Kb(),n.Lb(7,"p"),n.nc(8),n.Kb(),n.Lb(9,"table"),n.Lb(10,"tr"),n.Lb(11,"th"),n.nc(12,"Product"),n.Kb(),n.Kb(),n.lc(13,N,4,1,"tr",2),n.Kb()),2&t&&(n.yb(2),n.cc("formGroup",e.form),n.yb(6),n.pc("Searching for ",e.searchText,""),n.yb(5),n.cc("ngForOf",e.products))},directives:[K.r,K.i,K.e,K.a,K.h,K.d,u.l],styles:[""]}),t})(),j=(()=>{class t{canDeactivate(t,e,c,n){return!t.isDirty||window.confirm("do you want to leave without saving?")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=n.Eb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const q=[{path:"",component:d,canActivate:[o],children:[{path:"",component:y},{path:"edit/:id",component:M,canActivate:[i],canDeactivate:[j]},{path:"create",component:M,canDeactivate:[j]},{path:"search",component:V}]}];let B=(()=>{class t{}return t.\u0275mod=n.Gb({type:t}),t.\u0275inj=n.Fb({factory:function(e){return new(e||t)},imports:[[u.c,r.e.forChild(q),K.f,K.n,s.a]]}),t})()}}]);